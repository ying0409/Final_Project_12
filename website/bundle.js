(function (vega, vegaLite, vl, vegaTooltip, d3) {
  'use strict';

  vega = vega && Object.prototype.hasOwnProperty.call(vega, 'default') ? vega['default'] : vega;
  vegaLite = vegaLite && Object.prototype.hasOwnProperty.call(vegaLite, 'default') ? vegaLite['default'] : vegaLite;
  vl = vl && Object.prototype.hasOwnProperty.call(vl, 'default') ? vl['default'] : vl;

  // Appearance customization to improve readability.
  // See https://vega.github.io/vega-lite/docs/
  const dark = '#3e3c38';
  const config = {
    axis: {
      domain: false,
      tickColor: 'lightGray'
    },
    style: {
      "guide-label": {
        fontSize: 20,
        fill: dark
      },
      "guide-title": {
        fontSize: 15,
        fill: dark
      }
    }
  };

  const csvUrl = 'https://raw.githubusercontent.com/angelalien/Cloud-Native-final-project-website/main/data.csv'; 
  const getData = async () => {
    const data = await d3.csv(csvUrl);    
    //const data = await d3.csv('data.csv');
    
    // Have a look at the attributes available in the console!
    console.log(data[7]);
    
    return data;
  };

  const hover = vl.selectSingle("hover")
      .fields('Company')  // limit selection to x-axis value
      .on('mouseover') // select on mouseover events
      .nearest(true)   // select data point nearest the cursor
      .empty('none')
      .clear("mouseout").init({"Company": "dur"});

  const line = vl.markLine()
      .encode(
        vl
        .y()
        .fieldQ('Count')
        .title('Score'),
      vl
        .x()
        .fieldT('Date')
        .scale({ nice: false })
        .title('Date'),
      vl
        .color()
        .fieldN("Company").legend(null),
      vl.opacity()
        .if(hover,vl.value(1)).value(0.6),
      vl.strokeWidth().if(hover,vl.value(4)).value(2));
  const circle=
        vl.markCircle()
    .encode(
      vl
        .y()
        .fieldQ('Count')
        .title('Score'),
      vl
        .x()
        .fieldT('Date')
        .scale({nice: false })
        .title('Date'),
      vl
        .color()
        .fieldN("Company"),
      vl.opacity()
        .if(hover,vl.value(1)).value(0.6)
        .title('Signature'));

  const base = line.transform(vl.filter(hover));
  const label = {align: 'left', dx: 5, dy: -5};
  const white = {stroke: 'white', strokeWidth: 2};

  const viz =
    vl.layer(circle,
      line,
      line.markCircle()
          .select(hover) // use as anchor points for selection
          .encode(vl.opacity().if(hover, vl.value(1)).value(0)),   

      vl.markRule({color: '#aaa'})
          .transform(vl.filter(hover))
          .encode(vl.x().fieldT('date')),
      base.markText(label, white).encode(vl.text().fieldQ('Count')),
      base.markText(label).encode(vl.text().fieldQ('Count')));

  vl.register(vega, vegaLite, {
    view: { renderer: 'svg' },
    init: view => { view.tooltip(new vegaTooltip.Handler().call); }
  });

  const run = async () => {
    const marks = viz
      .data(await getData())
      .width(window.innerWidth*0.95)
      .height(window.innerHeight*0.7)
      .autosize({ type: 'fit', contains: 'padding' })
      .config(config);  
    
      document.body.appendChild(await marks.render());
  };
  run();

}(vega, vegaLite, vl, vegaTooltip, d3));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImNvbmZpZy5qcyIsImdldERhdGEuanMiLCJ2aXouanMiLCJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBcHBlYXJhbmNlIGN1c3RvbWl6YXRpb24gdG8gaW1wcm92ZSByZWFkYWJpbGl0eS5cbi8vIFNlZSBodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL1xuY29uc3QgZGFyayA9ICcjM2UzYzM4JztcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGF4aXM6IHtcbiAgICBkb21haW46IGZhbHNlLFxuICAgIHRpY2tDb2xvcjogJ2xpZ2h0R3JheSdcbiAgfSxcbiAgc3R5bGU6IHtcbiAgICBcImd1aWRlLWxhYmVsXCI6IHtcbiAgICAgIGZvbnRTaXplOiAyMCxcbiAgICAgIGZpbGw6IGRhcmtcbiAgICB9LFxuICAgIFwiZ3VpZGUtdGl0bGVcIjoge1xuICAgICAgZm9udFNpemU6IDE1LFxuICAgICAgZmlsbDogZGFya1xuICAgIH1cbiAgfVxufTsiLCJpbXBvcnQgeyBjc3YgfSBmcm9tICdkMyc7XG5cbmNvbnN0IGNzdlVybCA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYW5nZWxhbGllbi9DbG91ZC1OYXRpdmUtZmluYWwtcHJvamVjdC13ZWJzaXRlL21haW4vZGF0YS5jc3YnIFxuZXhwb3J0IGNvbnN0IGdldERhdGEgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBjc3YoY3N2VXJsKTtcbiAgXG4gIC8vY29uc3QgZGF0YSA9IGF3YWl0IGQzLmNzdignZGF0YS5jc3YnKTtcbiAgXG4gIC8vIEhhdmUgYSBsb29rIGF0IHRoZSBhdHRyaWJ1dGVzIGF2YWlsYWJsZSBpbiB0aGUgY29uc29sZSFcbiAgY29uc29sZS5sb2coZGF0YVs3XSk7XG4gIFxuICBcblxuICByZXR1cm4gZGF0YTtcbn07IiwiaW1wb3J0IHZsIGZyb20gJ3ZlZ2EtbGl0ZS1hcGknO1xuY29uc3QgaG92ZXIgPSB2bC5zZWxlY3RTaW5nbGUoXCJob3ZlclwiKVxuICAgIC5maWVsZHMoJ0NvbXBhbnknKSAgLy8gbGltaXQgc2VsZWN0aW9uIHRvIHgtYXhpcyB2YWx1ZVxuICAgIC5vbignbW91c2VvdmVyJykgLy8gc2VsZWN0IG9uIG1vdXNlb3ZlciBldmVudHNcbiAgICAubmVhcmVzdCh0cnVlKSAgIC8vIHNlbGVjdCBkYXRhIHBvaW50IG5lYXJlc3QgdGhlIGN1cnNvclxuICAgIC5lbXB0eSgnbm9uZScpXG4gICAgLmNsZWFyKFwibW91c2VvdXRcIikuaW5pdCh7XCJDb21wYW55XCI6IFwiZHVyXCJ9KTtcblxuY29uc3QgbGluZSA9IHZsLm1hcmtMaW5lKClcbiAgICAuZW5jb2RlKFxuICAgICAgdmxcbiAgICAgIC55KClcbiAgICAgIC5maWVsZFEoJ0NvdW50JylcbiAgICAgIC50aXRsZSgnU2NvcmUnKSxcbiAgICB2bFxuICAgICAgLngoKVxuICAgICAgLmZpZWxkVCgnRGF0ZScpXG4gICAgICAuc2NhbGUoeyBuaWNlOiBmYWxzZSB9KVxuICAgICAgLnRpdGxlKCdEYXRlJyksXG4gICAgdmxcbiAgICAgIC5jb2xvcigpXG4gICAgICAuZmllbGROKFwiQ29tcGFueVwiKS5sZWdlbmQobnVsbCksXG4gICAgdmwub3BhY2l0eSgpXG4gICAgICAuaWYoaG92ZXIsdmwudmFsdWUoMSkpLnZhbHVlKDAuNiksXG4gICAgdmwuc3Ryb2tlV2lkdGgoKS5pZihob3Zlcix2bC52YWx1ZSg0KSkudmFsdWUoMikpO1xuY29uc3QgY2lyY2xlPVxuICAgICAgdmwubWFya0NpcmNsZSgpXG4gIC5lbmNvZGUoXG4gICAgdmxcbiAgICAgIC55KClcbiAgICAgIC5maWVsZFEoJ0NvdW50JylcbiAgICAgIC50aXRsZSgnU2NvcmUnKSxcbiAgICB2bFxuICAgICAgLngoKVxuICAgICAgLmZpZWxkVCgnRGF0ZScpXG4gICAgICAuc2NhbGUoe25pY2U6IGZhbHNlIH0pXG4gICAgICAudGl0bGUoJ0RhdGUnKSxcbiAgICB2bFxuICAgICAgLmNvbG9yKClcbiAgICAgIC5maWVsZE4oXCJDb21wYW55XCIpLFxuICAgIHZsLm9wYWNpdHkoKVxuICAgICAgLmlmKGhvdmVyLHZsLnZhbHVlKDEpKS52YWx1ZSgwLjYpXG4gICAgICAudGl0bGUoJ1NpZ25hdHVyZScpKTtcblxuY29uc3QgYmFzZSA9IGxpbmUudHJhbnNmb3JtKHZsLmZpbHRlcihob3ZlcikpO1xuY29uc3QgbGFiZWwgPSB7YWxpZ246ICdsZWZ0JywgZHg6IDUsIGR5OiAtNX07XG5jb25zdCB3aGl0ZSA9IHtzdHJva2U6ICd3aGl0ZScsIHN0cm9rZVdpZHRoOiAyfTtcblxuZXhwb3J0IGNvbnN0IHZpeiA9XG4gIHZsLmxheWVyKGNpcmNsZSxcbiAgICBsaW5lLFxuICAgIGxpbmUubWFya0NpcmNsZSgpXG4gICAgICAgIC5zZWxlY3QoaG92ZXIpIC8vIHVzZSBhcyBhbmNob3IgcG9pbnRzIGZvciBzZWxlY3Rpb25cbiAgICAgICAgLmVuY29kZSh2bC5vcGFjaXR5KCkuaWYoaG92ZXIsIHZsLnZhbHVlKDEpKS52YWx1ZSgwKSksICAgXG5cbiAgICB2bC5tYXJrUnVsZSh7Y29sb3I6ICcjYWFhJ30pXG4gICAgICAgIC50cmFuc2Zvcm0odmwuZmlsdGVyKGhvdmVyKSlcbiAgICAgICAgLmVuY29kZSh2bC54KCkuZmllbGRUKCdkYXRlJykpLFxuICAgIGJhc2UubWFya1RleHQobGFiZWwsIHdoaXRlKS5lbmNvZGUodmwudGV4dCgpLmZpZWxkUSgnQ291bnQnKSksXG4gICAgYmFzZS5tYXJrVGV4dChsYWJlbCkuZW5jb2RlKHZsLnRleHQoKS5maWVsZFEoJ0NvdW50JykpKTtcbiIsImltcG9ydCB2ZWdhIGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHZlZ2FMaXRlIGZyb20gJ3ZlZ2EtbGl0ZSc7XG5pbXBvcnQgdmwgZnJvbSAndmVnYS1saXRlLWFwaSc7XG5pbXBvcnQgeyBIYW5kbGVyIH0gZnJvbSAndmVnYS10b29sdGlwJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJy4vY29uZmlnJztcbmltcG9ydCB7IGdldERhdGEgfSBmcm9tICcuL2dldERhdGEnO1xuaW1wb3J0IHsgdml6IH0gZnJvbSAnLi92aXonO1xuXG5cbnZsLnJlZ2lzdGVyKHZlZ2EsIHZlZ2FMaXRlLCB7XG4gIHZpZXc6IHsgcmVuZGVyZXI6ICdzdmcnIH0sXG4gIGluaXQ6IHZpZXcgPT4geyB2aWV3LnRvb2x0aXAobmV3IEhhbmRsZXIoKS5jYWxsKTsgfVxufSk7XG5cbmNvbnN0IHJ1biA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgbWFya3MgPSB2aXpcbiAgICAuZGF0YShhd2FpdCBnZXREYXRhKCkpXG4gICAgLndpZHRoKHdpbmRvdy5pbm5lcldpZHRoKVxuICAgIC5oZWlnaHQod2luZG93LmlubmVySGVpZ2h0KVxuICAgIC5hdXRvc2l6ZSh7IHR5cGU6ICdmaXQnLCBjb250YWluczogJ3BhZGRpbmcnIH0pXG4gICAgLmNvbmZpZyhjb25maWcpOyAgXG4gIFxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYXdhaXQgbWFya3MucmVuZGVyKCkpO1xufTtcbnJ1bigpOyJdLCJuYW1lcyI6WyJjc3YiLCJIYW5kbGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0VBQUE7RUFDQTtFQUNBLE1BQU0sSUFBSSxHQUFHLFNBQVMsQ0FBQztFQUNoQixNQUFNLE1BQU0sR0FBRztFQUN0QixFQUFFLElBQUksRUFBRTtFQUNSLElBQUksTUFBTSxFQUFFLEtBQUs7RUFDakIsSUFBSSxTQUFTLEVBQUUsV0FBVztFQUMxQixHQUFHO0VBQ0gsRUFBRSxLQUFLLEVBQUU7RUFDVCxJQUFJLGFBQWEsRUFBRTtFQUNuQixNQUFNLFFBQVEsRUFBRSxFQUFFO0VBQ2xCLE1BQU0sSUFBSSxFQUFFLElBQUk7RUFDaEIsS0FBSztFQUNMLElBQUksYUFBYSxFQUFFO0VBQ25CLE1BQU0sUUFBUSxFQUFFLEVBQUU7RUFDbEIsTUFBTSxJQUFJLEVBQUUsSUFBSTtFQUNoQixLQUFLO0VBQ0wsR0FBRztFQUNILENBQUM7O0VDaEJELE1B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QUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUM3QyxNQUFNLEtBQUssR0FBRyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ2hEO0VBQ08sTUFBTSxHQUFHO0VBQ2hCLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNO0VBQ2pCLElBQUksSUFBSTtFQUNSLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRTtFQUNyQixTQUFTLE1BQU0sQ0FBQyxLQUFLLENBQUM7RUFDdEIsU0FBUyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM3RDtFQUNBLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztFQUNoQyxTQUFTLFNBQVMsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0VBQ3BDLFNBQVMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7RUFDdEMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztFQUNqRSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQzs7RUNsRDNELEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRTtFQUM1QixFQUFFLElBQUksRUFBRSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUU7RUFDM0IsRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJQyxtQkFBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRTtFQUNyRCxDQUFDLENBQUMsQ0FBQztBQUNIO0VBQ0EsTUFBTSxHQUFHLEdBQUcsWUFBWTtFQUN4QixFQUFFLE1BQU0sS0FBSyxHQUFHLEdBQUc7RUFDbkIsS0FBSyxJQUFJLENBQUMsTUFBTSxPQUFPLEVBQUUsQ0FBQztFQUMxQixLQUFLLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDO0VBQzdCLEtBQUssTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7RUFDL0IsS0FBSyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsQ0FBQztFQUNuRCxLQUFLLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztFQUNwQjtFQUNBLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztFQUNwRCxDQUFDLENBQUM7RUFDRixHQUFHLEVBQUU7Ozs7In0=